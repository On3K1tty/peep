(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();class T{constructor(t=0,e=0,s=0){this.x=t,this.y=e,this.z=s}set(t,e,s){return this.x=t,this.y=e,this.z=s,this}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return new T(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return new T(this.x-t.x,this.y-t.y,this.z-t.z)}scale(t){return new T(this.x*t,this.y*t,this.z*t)}len(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){const t=this.len()||1;return new T(this.x/t,this.y/t,this.z/t)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){return new T(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}clone(){return new T(this.x,this.y,this.z)}}class v{constructor(){this.m=new Float64Array(16),this.m[0]=this.m[5]=this.m[10]=this.m[15]=1}static identity(){return new v}static perspective(t,e,s,i){const o=new v,a=o.m,n=1/Math.tan(t/2),r=1/(s-i);return a.fill(0),a[0]=n/e,a[5]=n,a[10]=(i+s)*r,a[11]=-1,a[14]=2*i*s*r,o}static translation(t,e,s){const i=new v;return i.m[12]=t,i.m[13]=e,i.m[14]=s,i}static rotationX(t){const e=new v,s=Math.cos(t),i=Math.sin(t);return e.m[5]=s,e.m[6]=i,e.m[9]=-i,e.m[10]=s,e}static rotationY(t){const e=new v,s=Math.cos(t),i=Math.sin(t);return e.m[0]=s,e.m[2]=-i,e.m[8]=i,e.m[10]=s,e}static rotationZ(t){const e=new v,s=Math.cos(t),i=Math.sin(t);return e.m[0]=s,e.m[1]=i,e.m[4]=-i,e.m[5]=s,e}static scaling(t,e,s){const i=new v;return i.m[0]=t,i.m[5]=e,i.m[10]=s,i}multiply(t){const e=new v,s=this.m,i=t.m,o=e.m;for(let a=0;a<4;a++)for(let n=0;n<4;n++)o[n*4+a]=s[a]*i[n*4]+s[4+a]*i[n*4+1]+s[8+a]*i[n*4+2]+s[12+a]*i[n*4+3];return e}invert(){const t=this.m,e=new v,s=e.m,i=t[0],o=t[1],a=t[2],n=t[3],r=t[4],c=t[5],d=t[6],l=t[7],u=t[8],p=t[9],m=t[10],_=t[11],b=t[12],f=t[13],S=t[14],x=t[15],L=i*c-o*r,D=i*d-a*r,C=i*l-n*r,A=o*d-a*c,B=o*l-n*c,R=a*l-n*d,$=u*f-p*b,N=u*S-m*b,O=u*x-_*b,Y=p*S-m*f,G=p*x-_*f,I=m*x-_*S;let y=L*I-D*G+C*Y+A*O-B*N+R*$;return y&&(y=1/y,s[0]=(c*I-d*G+l*Y)*y,s[1]=(a*G-o*I-n*Y)*y,s[2]=(f*R-S*B+x*A)*y,s[3]=(m*B-p*R-_*A)*y,s[4]=(d*O-r*I-l*N)*y,s[5]=(i*I-a*O+n*N)*y,s[6]=(S*C-b*R-x*D)*y,s[7]=(u*R-m*C+_*D)*y,s[8]=(r*G-c*O+l*$)*y,s[9]=(o*O-i*G-n*$)*y,s[10]=(b*B-f*C+x*L)*y,s[11]=(p*C-u*B-_*L)*y,s[12]=(c*N-r*Y-d*$)*y,s[13]=(i*Y-o*N+a*$)*y,s[14]=(f*D-b*A-S*L)*y,s[15]=(u*A-p*D+m*L)*y),e}toCSS(){const t=this.m;return`matrix3d(${t[0]},${t[1]},${t[2]},${t[3]},${t[4]},${t[5]},${t[6]},${t[7]},${t[8]},${t[9]},${t[10]},${t[11]},${t[12]},${t[13]},${t[14]},${t[15]})`}transformPoint(t){const e=this.m,s=e[3]*t.x+e[7]*t.y+e[11]*t.z+e[15]||1;return new T((e[0]*t.x+e[4]*t.y+e[8]*t.z+e[12])/s,(e[1]*t.x+e[5]*t.y+e[9]*t.z+e[13])/s,(e[2]*t.x+e[6]*t.y+e[10]*t.z+e[14])/s)}}const M=Math.PI/180;class Q{constructor(t="orbit"){this.mode=t,this.state={position:new T(0,5,10),rotationX:-25,rotationY:45,distance:20,target:new T(0,0,0)}}getViewMatrix(t=1){const e=t;if(this.mode==="orbit"){const a=v.rotationX(this.state.rotationX*M),n=v.rotationY(this.state.rotationY*M),r=v.translation(-this.state.target.x*e,this.state.target.y*e,-this.state.target.z*e);return v.translation(0,0,-this.state.distance*e).multiply(a).multiply(n).multiply(r)}const s=v.rotationX(-this.state.rotationX*M),i=v.rotationY(-this.state.rotationY*M),o=v.translation(-this.state.position.x*e,this.state.position.y*e,-this.state.position.z*e);return s.multiply(i).multiply(o)}orbit(t,e){this.state.rotationY+=t,this.state.rotationX=Math.max(-89,Math.min(89,this.state.rotationX+e))}zoom(t){this.state.distance=Math.max(2,Math.min(100,this.state.distance+t))}moveLocal(t,e,s){const i=this.state.rotationY*M,o=Math.sin(i),a=Math.cos(i);this.state.position.x+=e*a-t*o,this.state.position.y+=s,this.state.position.z+=e*o+t*a}}class tt{constructor(t,e,s=800,i=20){this.camera=e,this._perspectivePx=s,this._voxelSize=i,this.root=document.createElement("div"),this.root.className="voxel-world",Object.assign(this.root.style,{position:"relative",width:"100%",height:"100%",overflow:"hidden",contain:"strict",perspective:`${s}px`,perspectiveOrigin:"50% 50%"}),this.world=document.createElement("div"),Object.assign(this.world.style,{position:"absolute",left:"50%",top:"50%",transformStyle:"preserve-3d",willChange:"transform"}),this.root.appendChild(this.world),t.appendChild(this.root)}get voxelSize(){return this._voxelSize}get perspectivePx(){return this._perspectivePx}render(){const t=this.camera.getViewMatrix(this._voxelSize);this.world.style.transform=t.toCSS()}destroy(){this.root.remove()}}class dt{constructor(t){this.state={keys:new Set,pointerDown:!1,pointerX:0,pointerY:0,deltaX:0,deltaY:0,pinchDelta:0},this._listeners=[],this._lastTouchDist=0,this._el=t,this._bind()}onVoxelClick(t){this._onVoxelClick=t}resetDeltas(){this.state.deltaX=0,this.state.deltaY=0,this.state.pinchDelta=0}_on(t,e,s,i){t.addEventListener(e,s,i),this._listeners.push([t,e,s])}_bind(){this._on(window,"keydown",t=>{this.state.keys.add(t.code)}),this._on(window,"keyup",t=>{this.state.keys.delete(t.code)}),this._on(this._el,"mousedown",t=>{this.state.pointerDown=!0;const e=t;this.state.pointerX=e.clientX,this.state.pointerY=e.clientY}),this._on(window,"mouseup",()=>{this.state.pointerDown=!1}),this._on(window,"mousemove",t=>{const e=t;this.state.pointerDown&&(this.state.deltaX+=e.clientX-this.state.pointerX,this.state.deltaY+=e.clientY-this.state.pointerY),this.state.pointerX=e.clientX,this.state.pointerY=e.clientY}),this._on(this._el,"wheel",t=>{t.preventDefault(),this.state.pinchDelta+=t.deltaY*.01},{passive:!1}),this._on(this._el,"touchstart",t=>{t.preventDefault();const e=t;e.touches.length===1&&(this.state.pointerDown=!0,this.state.pointerX=e.touches[0].clientX,this.state.pointerY=e.touches[0].clientY),e.touches.length===2&&(this._lastTouchDist=this._touchDist(e))},{passive:!1}),this._on(this._el,"touchmove",t=>{t.preventDefault();const e=t;if(e.touches.length===1&&this.state.pointerDown){const s=e.touches[0].clientX,i=e.touches[0].clientY;this.state.deltaX+=s-this.state.pointerX,this.state.deltaY+=i-this.state.pointerY,this.state.pointerX=s,this.state.pointerY=i}if(e.touches.length===2){const s=this._touchDist(e);this.state.pinchDelta+=(this._lastTouchDist-s)*.05,this._lastTouchDist=s}},{passive:!1}),this._on(this._el,"touchend",()=>{this.state.pointerDown=!1}),this._on(this._el,"click",t=>{const e=t.target;e.dataset.vx!==void 0&&this._onVoxelClick&&this._onVoxelClick({x:Number(e.dataset.vx),y:Number(e.dataset.vy),z:Number(e.dataset.vz),normal:e.dataset.normal||""})})}_touchDist(t){const e=t.touches[0].clientX-t.touches[1].clientX,s=t.touches[0].clientY-t.touches[1].clientY;return Math.sqrt(e*e+s*s)}destroy(){for(const[t,e,s]of this._listeners)t.removeEventListener(e,s);this._listeners.length=0}}class ut{constructor(t){this._nodes=[],this._worldEl=t}add(t){this._nodes.push(t),this._worldEl.appendChild(t.el),t.update()}remove(t){const e=this._nodes.indexOf(t);e>=0&&this._nodes.splice(e,1),t.destroy()}clear(){for(const t of this._nodes)t.destroy();this._nodes.length=0}update(){for(const t of this._nodes)t.update()}get nodes(){return this._nodes}}class pt{constructor(t){this._running=!1,this._paused=!1,this._rafId=0,this._lastTime=0,this._updateCbs=[],this._tick=s=>{if(!this._running)return;if(this._rafId=requestAnimationFrame(this._tick),this._paused){this._lastTime=s;return}const i=Math.min((s-this._lastTime)/1e3,.1);this._lastTime=s;for(const o of this._updateCbs)o(i);this.scene.update(),this.renderer.render(),this.input.resetDeltas()};const e=typeof t.container=="string"?document.querySelector(t.container):t.container;if(!e)throw new Error("VoxelDOM: container not found");this.camera=new Q("orbit"),this.renderer=new tt(e,this.camera,t.perspective??800,t.voxelSize??16),this.scene=new ut(this.renderer.world),this.input=new dt(this.renderer.root)}get voxelSize(){return this.renderer.voxelSize}get running(){return this._running}get paused(){return this._paused}onUpdate(t){this._updateCbs.push(t)}clearCallbacks(){this._updateCbs.length=0}onVoxelClick(t){this.input.onVoxelClick(t)}start(){this._running||(this._running=!0,this._paused=!1,this._lastTime=performance.now(),this._tick(this._lastTime))}stop(){this._running=!1,cancelAnimationFrame(this._rafId)}pause(){this._paused=!0}resume(){this._paused=!1,this._lastTime=performance.now()}destroy(){this.stop(),this.scene.clear(),this.input.destroy(),this.renderer.destroy()}}const _t=[{normal:"top",axis:1,u:0,v:2,dir:1},{normal:"bottom",axis:1,u:0,v:2,dir:-1},{normal:"right",axis:0,u:2,v:1,dir:1},{normal:"left",axis:0,u:2,v:1,dir:-1},{normal:"front",axis:2,u:0,v:1,dir:1},{normal:"back",axis:2,u:0,v:1,dir:-1}];function mt(h,t,e=32){const s=[],i=e*e;function o(c,d,l){return c+d*e+l*i}function a(c,d,l){return c<0||c>=e||d<0||d>=e||l<0||l>=e?!1:h[o(c,d,l)]!==0}function n(c,d,l){return c<0||c>=e||d<0||d>=e||l<0||l>=e?0:h[o(c,d,l)]}const r=new Int32Array(e*e);for(const c of _t)for(let d=0;d<e;d++){r.fill(0);for(let l=0;l<e;l++)for(let u=0;u<e;u++){const p=[0,0,0];p[c.axis]=d,p[c.u]=u,p[c.v]=l;const m=n(p[0],p[1],p[2]);if(m===0)continue;const _=[0,0,0];_[c.axis]=d+c.dir,_[c.u]=u,_[c.v]=l,!a(_[0],_[1],_[2])&&(r[l*e+u]=m)}for(let l=0;l<e;l++)for(let u=0;u<e;){const p=r[l*e+u];if(p===0){u++;continue}let m=1;for(;u+m<e&&r[l*e+u+m]===p;)m++;let _=1,b=!1;for(;l+_<e&&!b;){for(let S=0;S<m;S++)if(r[(l+_)*e+u+S]!==p){b=!0;break}b||_++}for(let S=0;S<_;S++)for(let x=0;x<m;x++)r[(l+S)*e+u+x]=0;const f=[0,0,0];f[c.axis]=d,f[c.u]=u,f[c.v]=l,s.push({x:f[0],y:f[1],z:f[2],w:m,h:_,normal:c.normal,color:t[p]||"#ff00ff"}),u+=m}}return s}const gt={top:1,front:.85,back:.7,right:.8,left:.75,bottom:.6};class et{constructor(t=16){this.position={x:0,y:0,z:0},this.rotation={x:0,y:0,z:0},this.scale={x:1,y:1,z:1},this._faceEls=[],this._faceCount=0,this._voxelSize=t,this.el=document.createElement("div"),this.el.style.position="absolute",this.el.style.transformStyle="preserve-3d",this.el.style.willChange="transform"}get faceCount(){return this._faceCount}rebuildFromGrid(t,e,s=32){const i=mt(t,e,s);this._faceCount=i.length;for(const a of this._faceEls)a.remove();this._faceEls.length=0;const o=this._voxelSize;for(const a of i){const n=document.createElement("div"),r=a.w*o,c=a.h*o;n.className="vf",n.style.cssText=`position:absolute;width:${r}px;height:${c}px;backface-visibility:hidden;transform-origin:0 0;image-rendering:pixelated;pointer-events:auto;background:${a.color};filter:brightness(${gt[a.normal]})`,n.style.transform=ft(a,o),n.dataset.n=a.normal,n.dataset.x=String(a.x),n.dataset.y=String(a.y),n.dataset.z=String(a.z),this.el.appendChild(n),this._faceEls.push(n)}}update(){const t=this._voxelSize,e=v.translation(this.position.x*t,-this.position.y*t,this.position.z*t),s=v.rotationY(this.rotation.y*M);this.el.style.transform=e.multiply(s).toCSS()}destroy(){for(const t of this._faceEls)t.remove();this._faceEls.length=0,this.el.remove()}}function ft(h,t){const e=h.x,s=h.y,i=h.z;switch(h.normal){case"top":return`translate3d(${e*t}px,${-(s+1)*t}px,${i*t}px) rotateX(90deg)`;case"bottom":return`translate3d(${e*t}px,${-s*t}px,${(i+h.h)*t}px) rotateX(-90deg)`;case"front":return`translate3d(${e*t}px,${-(s+h.h)*t}px,${(i+1)*t}px)`;case"back":return`translate3d(${(e+h.w)*t}px,${-(s+h.h)*t}px,${i*t}px) rotateY(180deg)`;case"right":return`translate3d(${(e+1)*t}px,${-(s+h.h)*t}px,${(i+h.w)*t}px) rotateY(90deg)`;case"left":return`translate3d(${e*t}px,${-(s+h.h)*t}px,${i*t}px) rotateY(-90deg)`}}var E=(h=>(h[h.SOLID=0]="SOLID",h[h.DEADLY=1]="DEADLY",h[h.BOUNCY=2]="BOUNCY",h[h.PICKUP=3]="PICKUP",h[h.SPAWN=4]="SPAWN",h[h.FINISH=5]="FINISH",h[h.MOVER=6]="MOVER",h[h.PORTAL=7]="PORTAL",h))(E||{});const st=["solid","deadly","bouncy","pickup","spawn","finish","mover","portal"],yt=32,g=yt,it=g*g,X=g*g*g,vt=["","#4CAF50","#795548","#9E9E9E","#F44336","#2196F3","#FFEB3B","#FF9800","#9C27B0","#FFFFFF","#212121","#E91E63","#00BCD4","#8BC34A","#FF5722","#607D8B"];class ht{constructor(){this.triggers=[],this.moverPaths={},this.portalTargets={},this.name="Untitled",this._spawnPos=[16,20,16],this.grid=new Uint8Array(X),this.roles=new Uint8Array(X),this.palette=[...vt]}_idx(t,e,s){return t+e*g+s*it}get(t,e,s){return t<0||t>=g||e<0||e>=g||s<0||s>=g?0:this.grid[this._idx(t,e,s)]}getRole(t,e,s){return t<0||t>=g||e<0||e>=g||s<0||s>=g?0:this.roles[this._idx(t,e,s)]}set(t,e,s,i,o=E.SOLID){if(t<0||t>=g||e<0||e>=g||s<0||s>=g)return;const a=this._idx(t,e,s);this.grid[a]=i,this.roles[a]=o,o===E.SPAWN&&(this._spawnPos=[t,e+1,s])}clear(t,e,s){if(t<0||t>=g||e<0||e>=g||s<0||s>=g)return;const i=this._idx(t,e,s);this.grid[i]=0,this.roles[i]=0}isSolid(t,e,s){return this.get(Math.floor(t),Math.floor(e),Math.floor(s))!==0}roleAt(t,e,s){return this.getRole(Math.floor(t),Math.floor(e),Math.floor(s))}get spawnPos(){return[...this._spawnPos]}findSpawn(){for(let t=0;t<X;t++)if(this.roles[t]===E.SPAWN){const e=t%g,s=Math.floor(t/g)%g,i=Math.floor(t/it);return[e,s+1,i]}return[16,20,16]}reset(){this.grid.fill(0),this.roles.fill(0),this.triggers=[],this.moverPaths={},this.portalTargets={},this._spawnPos=[16,20,16]}generateDefault(){this.reset();for(let t=0;t<g;t++)for(let e=0;e<g;e++)this.set(t,0,e,1),(t===0||t===g-1||e===0||e===g-1)&&this.set(t,0,e,3);this.set(4,1,4,6,E.SPAWN);for(let t=4;t<20;t++)this.set(4,0,t,3),this.set(5,0,t,3);this._placeWheelchairPerson(14,1,14)}_placeWheelchairPerson(t,e,s){const l=(p,m,_,b)=>this.set(t+p,e+m,s+_,b),u=(p,m,_,b,f,S)=>{for(let x=p;x<=m;x++)for(let L=b;L<=f;L++)l(x,_,L,S)};l(0,0,1,10),l(0,0,2,10),l(0,0,3,10),l(0,0,4,10),l(5,0,1,10),l(5,0,2,10),l(5,0,3,10),l(5,0,4,10),l(2,0,5,10),l(3,0,5,10),l(0,1,0,10),l(0,1,5,10),l(5,1,0,10),l(5,1,5,10),u(1,4,1,3,3,3),l(1,1,4,3),l(1,1,5,3),l(4,1,4,3),l(4,1,5,3),l(0,2,0,10),l(0,2,5,10),l(5,2,0,10),l(5,2,5,10),u(1,4,2,1,4,3),l(0,3,1,10),l(0,3,2,10),l(0,3,3,10),l(0,3,4,10),l(5,3,1,10),l(5,3,2,10),l(5,3,3,10),l(5,3,4,10),u(1,4,3,1,4,4),l(2,4,2,15),l(2,4,3,15),l(2,4,4,15),l(3,4,2,15),l(3,4,3,15),l(3,4,4,15),l(2,4,5,10),l(3,4,5,10),u(1,4,4,0,0,3),l(0,4,1,3),l(0,4,2,3),l(0,4,3,3),l(5,4,1,3),l(5,4,2,3),l(5,4,3,3),u(1,4,5,0,0,3),l(1,5,1,5),l(2,5,1,5),l(3,5,1,5),l(4,5,1,5),u(1,4,6,0,0,3),u(1,4,6,1,1,5),l(0,6,2,7),l(5,6,2,7),u(1,4,7,1,2,5),l(0,7,1,7),l(5,7,1,7),l(2,8,1,7),l(3,8,1,7),u(1,4,9,0,2,7),l(2,9,2,9),l(3,9,2,9),u(1,4,10,0,2,7),u(1,4,10,0,0,10),u(1,4,11,0,1,10)}serialize(){return{v:1,size:g,grid:at(this.grid),roles:at(this.roles),palette:this.palette,triggers:this.triggers,moverPaths:this.moverPaths,portalTargets:this.portalTargets,name:this.name}}deserialize(t){this.reset(),ot(t.grid,this.grid),ot(t.roles,this.roles),this.palette=t.palette,this.triggers=t.triggers||[],this.moverPaths=t.moverPaths||{},this.portalTargets=t.portalTargets||{},this.name=t.name||"Untitled",this._spawnPos=this.findSpawn()}}function at(h){const t=[];let e=0;for(;e<h.length;){const s=h[e];let i=1;for(;e+i<h.length&&h[e+i]===s&&i<255;)i++;t.push(i,s),e+=i}return t}function ot(h,t){let e=0;for(let s=0;s<h.length;s+=2){const i=h[s],o=h[s+1];for(let a=0;a<i&&e<t.length;a++)t[e++]=o}}const wt=25,bt=9,nt=6,W=1.6,St=.3;class xt{constructor(t){this._pickedUp=new Set,this._world=t;const[e,s,i]=t.findSpawn();this.state={x:e+.5,y:s,z:i+.5,vx:0,vy:0,vz:0,yaw:0,grounded:!1,alive:!0,score:0,won:!1}}respawn(){const[t,e,s]=this._world.findSpawn();this.state.x=t+.5,this.state.y=e,this.state.z=s+.5,this.state.vx=0,this.state.vy=0,this.state.vz=0,this.state.grounded=!1,this.state.alive=!0,this.state.won=!1}move(t,e,s,i){if(!this.state.alive||this.state.won)return null;const o=this.state,a=Math.sin(o.yaw),n=Math.cos(o.yaw),r=(-t*a+e*n)*nt,c=(t*n+e*a)*nt;if(o.vx=r,o.vz=c,o.vy-=wt*i,s&&o.grounded)return o.vy=bt,o.grounded=!1,"jump";let d=null;return d=this._integrate(i),d}_integrate(t){const e=this.state,s=this._world;let i=null;const o=e.x+e.vx*t;this._collidesAt(o,e.y,e.z)?e.vx=0:e.x=o;const a=e.z+e.vz*t;this._collidesAt(e.x,e.y,a)?e.vz=0:e.z=a;const n=e.y+e.vy*t;if(!this._collidesAt(e.x,n,e.z))e.y=n,e.grounded=!1;else{e.vy<0&&(e.y=Math.floor(e.y)+.001,e.grounded=!0);const m=e.vy<0?Math.floor(e.y-.1):Math.floor(e.y+W);s.roleAt(Math.floor(e.x),m,Math.floor(e.z))===E.BOUNCY?(e.vy=-e.vy*1.3,e.grounded=!1,i="jump"):e.vy=0}const r=Math.floor(e.x),c=Math.floor(e.y),d=Math.floor(e.z),l=s.roleAt(r,c,d),u=s.roleAt(r,c+1,d),p=l||u;if(p===E.DEADLY)e.alive=!1,i="hit";else if(p===E.PICKUP){const m=l===E.PICKUP?c:c+1,_=`${r},${m},${d}`;this._pickedUp.has(_)||(this._pickedUp.add(_),s.clear(r,m,d),e.score++,i="pickup")}else if(p===E.FINISH)e.won=!0,i="win";else if(p===E.PORTAL){const m=`${r},${c},${d}`,_=s.portalTargets[m];_&&(e.x=_[0]+.5,e.y=_[1],e.z=_[2]+.5,i="pickup")}return e.y<-5&&(e.alive=!1,i="hit"),i}_collidesAt(t,e,s){const i=this._world,o=St;for(let a=0;a<W;a+=.8){const n=e+a;if(i.isSolid(t-o,n,s-o)||i.isSolid(t+o,n,s-o)||i.isSolid(t-o,n,s+o)||i.isSolid(t+o,n,s+o))return!0}return!!i.isSolid(t,e+W,s)}}class kt{constructor(){this._fired=new Set,this._timers=new Map}reset(){this._fired.clear(),this._timers.clear()}evaluate(t,e,s,i){const o=[];for(const a of t){if(this._fired.has(a.id))continue;let n=!1;switch(a.type){case"touch":if(a.target){const r=Math.floor(e.x),c=Math.floor(e.y),d=Math.floor(e.z),[l,u,p]=a.target;n=r===l&&(c===u||c+1===u)&&d===p}break;case"click":break;case"timer":{const r=(this._timers.get(a.id)??0)+i;this._timers.set(a.id,r),n=r>=(a.params.seconds??10);break}case"score_gte":n=e.score>=(a.params.score??1);break}if(n){this._fired.add(a.id);const r=this._executeAction(a,e,s);r&&o.push(r)}}return o}checkClick(t,e,s,i,o,a){const n=[];for(const r of t)if(!(r.type!=="click"||this._fired.has(r.id))&&r.target&&r.target[0]===e&&r.target[1]===s&&r.target[2]===i){this._fired.add(r.id);const c=this._executeAction(r,o,a);c&&n.push(c)}return n}_executeAction(t,e,s){switch(t.action){case"text":return{type:"text",text:t.params.text??""};case"sound":return{type:"sound",sound:t.params.sound??"pickup"};case"win":return e.won=!0,{type:"win"};case"lose":return e.alive=!1,{type:"lose"};case"teleport":return t.params.x!=null?(e.x=t.params.x+.5,e.y=t.params.y,e.z=t.params.z+.5,{type:"teleport",x:t.params.x,y:t.params.y,z:t.params.z}):null;case"destroy":return t.target&&s.clear(t.target[0],t.target[1],t.target[2]),{type:"sound",sound:"explode"};case"spawn_block":return t.params.x!=null&&s.set(t.params.x,t.params.y,t.params.z,t.params.blockId??1),{type:"sound",sound:"pickup"}}return null}}const rt=.12;class Et{constructor(){this.enabled=!1,this._baseAlpha=0,this._baseBeta=0,this._targetYaw=0,this._targetPitch=0,this._hasPermission=!1,this._handler=null}async requestPermission(){const t=DeviceOrientationEvent;if(typeof t.requestPermission=="function")try{const e=await t.requestPermission();this._hasPermission=e==="granted"}catch{this._hasPermission=!1}else this._hasPermission=!0;return this._hasPermission}start(){!this._hasPermission||this._handler||(this.enabled=!0,this._handler=t=>{t.alpha==null||t.beta==null||(this._targetYaw=(t.alpha-this._baseAlpha)*.4,this._targetPitch=(t.beta-this._baseBeta)*.4)},window.addEventListener("deviceorientation",this._handler))}stop(){this.enabled=!1,this._handler&&(window.removeEventListener("deviceorientation",this._handler),this._handler=null)}calibrate(){this._baseAlpha+=this._targetYaw/.4,this._baseBeta+=this._targetPitch/.4,this._targetYaw=0,this._targetPitch=0}update(t){this.enabled&&(t.state.rotationY+=(this._targetYaw-t.state.rotationY)*rt,t.state.rotationX+=(Math.max(-89,Math.min(89,this._targetPitch))-t.state.rotationX)*rt)}destroy(){this.stop()}}class Tt{constructor(){this._toastTimer=0,this._moveState={u:!1,d:!1,l:!1,r:!1},this.el=document.createElement("div"),this.el.className="hud",this.el.innerHTML='<div class="hud-top"><span class="hud-score">0</span></div><div class="hud-crosshair">+</div><div class="hud-msg"></div><div class="hud-toast"></div><div class="hud-dpad"><button class="dp dp-u" data-d="u">&#9650;</button><button class="dp dp-l" data-d="l">&#9664;</button><button class="dp dp-r" data-d="r">&#9654;</button><button class="dp dp-d" data-d="d">&#9660;</button><button class="dp dp-j" data-d="j">&#8679;</button></div><button class="hud-shoot">&#9678;</button>',this._msg=this.el.querySelector(".hud-msg"),this._toast=this.el.querySelector(".hud-toast"),this._dpad=this.el.querySelector(".hud-dpad"),this._shootBtn=this.el.querySelector(".hud-shoot"),this._crosshair=this.el.querySelector(".hud-crosshair"),this._bindDpad(),this._shootBtn.addEventListener("touchstart",t=>{var e;t.preventDefault(),(e=this.onShoot)==null||e.call(this)},{passive:!1}),this._shootBtn.addEventListener("mousedown",t=>{var e;t.preventDefault(),(e=this.onShoot)==null||e.call(this)})}_bindDpad(){const t=s=>{var o;s.preventDefault();const i=s.target.dataset.d;if(i){if(i==="j"){(o=this.onJump)==null||o.call(this);return}this._moveState[i]=!0}},e=s=>{s.preventDefault();const i=s.target.dataset.d;i&&i!=="j"&&(this._moveState[i]=!1)};this._dpad.addEventListener("touchstart",t,{passive:!1}),this._dpad.addEventListener("touchend",e,{passive:!1}),this._dpad.addEventListener("mousedown",t),this._dpad.addEventListener("mouseup",e),this._dpad.addEventListener("mouseleave",e)}getMoveInput(){const t=this._moveState;return{forward:(t.u?1:0)-(t.d?1:0),right:(t.r?1:0)-(t.l?1:0)}}setScore(t){}showMessage(t){this._msg.textContent=t,this._msg.style.display=t?"block":"none"}toast(t,e=2e3){this._toast.textContent=t,this._toast.classList.add("show"),clearTimeout(this._toastTimer),this._toastTimer=window.setTimeout(()=>{this._toast.classList.remove("show")},e)}setDpadVisible(t){this._dpad.style.display=t?"flex":"none",this._shootBtn.style.display=t?"flex":"none",this._crosshair.style.display=t?"block":"none"}destroy(){this.el.remove()}}let j=null;function Lt(){return j||(j=new AudioContext),j.state==="suspended"&&j.resume(),j}function w(h){try{const t=Lt(),e=t.currentTime;switch(h){case"jump":{const s=t.createOscillator(),i=t.createGain();s.type="sine",s.frequency.setValueAtTime(250,e),s.frequency.linearRampToValueAtTime(600,e+.12),i.gain.setValueAtTime(.15,e),i.gain.linearRampToValueAtTime(0,e+.15),s.connect(i).connect(t.destination),s.start(e),s.stop(e+.15);break}case"hit":{const s=t.createBuffer(1,t.sampleRate*.2|0,t.sampleRate),i=s.getChannelData(0);for(let n=0;n<i.length;n++)i[n]=(Math.random()*2-1)*(1-n/i.length);const o=t.createBufferSource(),a=t.createGain();o.buffer=s,a.gain.setValueAtTime(.2,e),a.gain.linearRampToValueAtTime(0,e+.2),o.connect(a).connect(t.destination),o.start(e);break}case"pickup":{const s=t.createOscillator(),i=t.createOscillator(),o=t.createGain();s.type="square",s.frequency.value=523,i.type="square",i.frequency.value=659,o.gain.setValueAtTime(.08,e),o.gain.linearRampToValueAtTime(0,e+.2),s.connect(o),i.connect(o),o.connect(t.destination),s.start(e),s.stop(e+.1),i.start(e+.08),i.stop(e+.2);break}case"explode":{const s=t.createBuffer(1,t.sampleRate*.4|0,t.sampleRate),i=s.getChannelData(0);for(let r=0;r<i.length;r++)i[r]=(Math.random()*2-1)*(1-r/i.length)**.5;const o=t.createBufferSource(),a=t.createGain(),n=t.createBiquadFilter();n.type="lowpass",n.frequency.value=400,o.buffer=s,a.gain.setValueAtTime(.3,e),a.gain.linearRampToValueAtTime(0,e+.4),o.connect(n).connect(a).connect(t.destination),o.start(e);break}case"win":{[523,659,784,1047].forEach((i,o)=>{const a=t.createOscillator(),n=t.createGain();a.type="square",a.frequency.value=i,n.gain.setValueAtTime(.08,e+o*.12),n.gain.linearRampToValueAtTime(0,e+o*.12+.15),a.connect(n).connect(t.destination),a.start(e+o*.12),a.stop(e+o*.12+.15)});break}case"lose":{const s=t.createOscillator(),i=t.createGain();s.type="sawtooth",s.frequency.setValueAtTime(400,e),s.frequency.linearRampToValueAtTime(100,e+.4),i.gain.setValueAtTime(.12,e),i.gain.linearRampToValueAtTime(0,e+.5),s.connect(i).connect(t.destination),s.start(e),s.stop(e+.5);break}case"click":{const s=t.createOscillator(),i=t.createGain();s.type="sine",s.frequency.value=800,i.gain.setValueAtTime(.05,e),i.gain.linearRampToValueAtTime(0,e+.05),s.connect(i).connect(t.destination),s.start(e),s.stop(e+.05);break}case"place":{const s=t.createOscillator(),i=t.createGain();s.type="sine",s.frequency.value=180,i.gain.setValueAtTime(.04,e),i.gain.linearRampToValueAtTime(0,e+.14),s.connect(i).connect(t.destination),s.start(e),s.stop(e+.14);break}}}catch{}}const z=7,F=5,P=30,K=10;class zt{constructor(t){this._raf=0,this._running=!1,this._lastTime=0,this._px=3.5,this._py=1,this._pz=2,this._pSpeed=0,this._steer=0,this._pills=0,this._bx=3.5,this._bz=2,this._bSpeed=0,this._bDodge=0,this._bDodgeTimer=0,this._pillEls=[],this._countdown=3,this._started=!1,this._finished=!1,this._onKey=o=>{(o.code==="ArrowLeft"||o.code==="KeyA")&&(this._steer=-1),(o.code==="ArrowRight"||o.code==="KeyD")&&(this._steer=1)},this._onKeyUp=o=>{(o.code==="ArrowLeft"||o.code==="KeyA"||o.code==="ArrowRight"||o.code==="KeyD")&&(this._steer=0)},this._tick=o=>{if(!this._running)return;this._raf=requestAnimationFrame(this._tick);const a=Math.min((o-this._lastTime)/1e3,.1);if(this._lastTime=o,this._started||(this._countdown-=a,this._countdown>0?this._goEl.textContent=String(Math.ceil(this._countdown)):(this._goEl.textContent="GO!",this._started=!0,setTimeout(()=>this._goEl.classList.remove("show"),600),w("win"))),this._started&&!this._finished){this._pSpeed=Math.min(this._pSpeed+4*a,8),this._pz+=this._pSpeed*a,this._px+=this._steer*4*a,this._px=Math.max(1.2,Math.min(z-1.2,this._px)),this._bSpeed=Math.min(this._bSpeed+3.5*a,7+Math.random()*.5),this._bz+=this._bSpeed*a,this._bDodgeTimer-=a,this._bDodgeTimer<=0&&(this._bDodge=(Math.random()-.5)*3,this._bDodgeTimer=.5+Math.random()*1.5),this._bx+=this._bDodge*a,this._bx=Math.max(1.2,Math.min(z-1.2,this._bx));for(const c of this._pillEls){if(c.collected)continue;Math.abs(this._px-c.x)+Math.abs(this._pz-c.z)<1.2&&(c.collected=!0,c.el.style.display="none",this._pills++,w("pickup"))}if(this._pz>=P-1.5||this._bz>=P-1.5){this._finished=!0;const c=this._pz>=this._bz;w(c?"win":"lose"),setTimeout(()=>{var d;return(d=this.onFinish)==null?void 0:d.call(this,c)},1500)}this._pillsEl.textContent=`ðŸ’Š ${this._pills}`;const r=this._pz>this._bz;this._posEl.textContent=r?"1st":"2nd",this._posEl.style.color=r?"#4CAF50":"#F44336"}this._positionSprite(this._playerEl,this._px-.4,1,this._pz),this._positionSprite(this._botEl,this._bx-.4,1,this._bz);for(const r of this._pillEls)r.collected||this._positionSprite(r.el,r.x-.2,1.8+Math.sin(o*.003)*.2,r.z);const n=this._cam.state;n.target.x+=(this._px-n.target.x)*.1,n.target.y=2.5,n.target.z+=(this._pz+2-n.target.z)*.1,n.rotationY+=(0-n.rotationY)*.05,this._renderer.render()},this._container=t,this._wrap=document.createElement("div"),this._wrap.style.cssText="position:fixed;inset:0;z-index:250;",t.appendChild(this._wrap),this._world=new ht,this._buildCorridor(),this._cam=new Q("orbit"),this._cam.state.distance=12,this._cam.state.rotationX=-15,this._cam.state.rotationY=0,this._cam.state.target.set(this._px,2,this._pz+3),this._renderer=new tt(this._wrap,this._cam,500,K),this._mesh=new et(K),this._renderer.world.appendChild(this._mesh.el),this._mesh.el.style.transformStyle="preserve-3d",this._mesh.rebuildFromGrid(this._world.grid,this._world.palette),this._playerEl=this._makeSprite("#4CAF50",.8,1.2),this._renderer.world.appendChild(this._playerEl),this._botEl=this._makeSprite("#F44336",.8,1.2),this._renderer.world.appendChild(this._botEl);for(let o=4;o<P-2;o+=3){const a=1.5+Math.random()*(z-3),n=this._makeSprite("#FFEB3B",.4,.4);this._renderer.world.appendChild(n),this._pillEls.push({el:n,z:o+.5,x:a,collected:!1})}this._hud=document.createElement("div"),this._hud.className="race-hud",this._hud.innerHTML='<div class="race-pills">0</div><div class="race-pos"></div><div class="race-go"></div><div class="race-steer"><button class="rs-l">&larr;</button><button class="rs-r">&rarr;</button></div>',this._wrap.appendChild(this._hud),this._pillsEl=this._hud.querySelector(".race-pills"),this._posEl=this._hud.querySelector(".race-pos"),this._goEl=this._hud.querySelector(".race-go");const e=this._hud.querySelector(".rs-l"),s=this._hud.querySelector(".rs-r"),i=o=>{this._steer=o};e.addEventListener("touchstart",o=>{o.preventDefault(),i(-1)},{passive:!1}),e.addEventListener("touchend",()=>i(0)),e.addEventListener("mousedown",()=>i(-1)),e.addEventListener("mouseup",()=>i(0)),s.addEventListener("touchstart",o=>{o.preventDefault(),i(1)},{passive:!1}),s.addEventListener("touchend",()=>i(0)),s.addEventListener("mousedown",()=>i(1)),s.addEventListener("mouseup",()=>i(0)),window.addEventListener("keydown",this._onKey),window.addEventListener("keyup",this._onKeyUp)}_buildCorridor(){const t=this._world;t.reset();const e=9,s=3,i=2,o=1;for(let a=0;a<P;a++)for(let n=0;n<z;n++)if(t.set(n,0,a,(n+a)%2===0?s:e),t.set(n,F,a,s),n===0||n===z-1)for(let r=1;r<=F;r++)t.set(n,r,a,e);for(let a=0;a<z;a++)for(let n=0;n<=F;n++)t.set(a,n,0,s);for(let a=2;a<z-2;a++)for(let n=1;n<F;n++)t.set(a,n,P-1,o);for(let a=6;a<P-4;a+=7){const n=a%2===0?1:z-3;for(let r=0;r<2;r++)t.set(n+r,1,a,i),t.set(n+r,1,a+1,i)}for(let a=5;a<P-3;a+=5){const n=2+Math.floor(Math.random()*(z-4));t.set(n,1,a,5),t.set(n,2,a,9)}}_makeSprite(t,e,s){const i=document.createElement("div"),o=K;return i.style.cssText=`position:absolute;width:${e*o}px;height:${s*o}px;background:${t};border-radius:2px;transform-style:preserve-3d;transform-origin:50% 100%;`,i}_positionSprite(t,e,s,i){const o=K;t.style.transform=`translate3d(${e*o}px,${-s*o}px,${i*o}px)`}start(){this._running=!0,this._lastTime=performance.now(),this._countdown=3,this._started=!1,this._finished=!1,this._pSpeed=0,this._bSpeed=0,this._pz=2,this._bz=2,this._bx=3.5,this._pills=0,this._goEl.textContent="3",this._goEl.classList.add("show"),this._tick(this._lastTime)}destroy(){this._running=!1,cancelAnimationFrame(this._raf),window.removeEventListener("keydown",this._onKey),window.removeEventListener("keyup",this._onKeyUp),this._wrap.remove()}}class Pt{constructor(t){this._selected=1,this._role=E.SOLID,this._colors=t,this.el=document.createElement("div"),this.el.className="palette-bar edit-only",this._renderSwatches(),this.roleBar=document.createElement("div"),this.roleBar.className="role-bar edit-only",this._renderRoles()}get selectedColor(){return this._selected}get selectedRole(){return this._role}get colorHex(){return this._colors[this._selected]||"#ff00ff"}_renderSwatches(){this.el.innerHTML="";for(let t=1;t<this._colors.length;t++){const e=document.createElement("div");e.className="pal-swatch"+(t===this._selected?" active":""),e.style.background=this._colors[t],e.dataset.i=String(t),this.el.appendChild(e)}this.el.addEventListener("click",t=>{var s;const e=t.target.closest(".pal-swatch");e&&(this._selected=Number(e.dataset.i),this.el.querySelectorAll(".pal-swatch").forEach(i=>i.classList.toggle("active",i===e)),(s=this.onChange)==null||s.call(this,this._selected,this._role))})}_renderRoles(){this.roleBar.innerHTML="";for(let t=0;t<st.length;t++){const e=document.createElement("button");e.className="role-btn"+(t===this._role?" active":""),e.textContent=st[t],e.dataset.r=String(t),this.roleBar.appendChild(e)}this.roleBar.addEventListener("click",t=>{var s;const e=t.target.closest(".role-btn");e&&(this._role=Number(e.dataset.r),this.roleBar.querySelectorAll(".role-btn").forEach(i=>i.classList.toggle("active",i===e)),(s=this.onChange)==null||s.call(this,this._selected,this._role))})}showRoles(t){this.roleBar.classList.toggle("show",t)}destroy(){this.el.remove(),this.roleBar.remove()}}const Mt=["touch","click","timer","score_gte"],Dt=["destroy","teleport","text","sound","win","lose","spawn_block"];class Ct{constructor(){this._triggers=[],this._nextId=1,this.el=document.createElement("div"),this.el.className="trigger-panel",this.el.innerHTML='<button class="btn-close-panel">&times;</button><h3>Triggers</h3><div class="trigger-list"></div><button class="btn-add-trigger">+ Add Trigger</button>',this._list=this.el.querySelector(".trigger-list"),this.el.querySelector(".btn-close-panel").addEventListener("click",()=>this.hide()),this.el.querySelector(".btn-add-trigger").addEventListener("click",()=>this._addTrigger())}show(){this.el.classList.add("show")}hide(){this.el.classList.remove("show")}get visible(){return this.el.classList.contains("show")}load(t){this._triggers=[...t],this._nextId=t.reduce((e,s)=>Math.max(e,s.id+1),1),this._render()}_addTrigger(){this._triggers.push({id:this._nextId++,type:"touch",target:[0,0,0],action:"text",params:{text:"Hello!"}}),this._render(),this._emit()}_removeTrigger(t){this._triggers=this._triggers.filter(e=>e.id!==t),this._render(),this._emit()}_render(){this._list.innerHTML="";for(const t of this._triggers){const e=document.createElement("div");e.className="trigger-card",e.innerHTML=`<label>IF</label><select class="t-type">${Mt.map(i=>`<option value="${i}"${i===t.type?" selected":""}>${i}</option>`).join("")}</select><label>Target Block (x,y,z)</label><input class="t-target" value="${t.target?t.target.join(","):""}" placeholder="x,y,z"><label>THEN</label><select class="t-action">${Dt.map(i=>`<option value="${i}"${i===t.action?" selected":""}>${i}</option>`).join("")}</select><label>Params (JSON)</label><input class="t-params" value='${JSON.stringify(t.params)}'><button class="role-btn" style="margin-top:6px;color:#f44336">Delete</button>`;const s=t.id;e.querySelector(".t-type").addEventListener("change",i=>{t.type=i.target.value,this._emit()}),e.querySelector(".t-target").addEventListener("change",i=>{const o=i.target.value.split(",").map(Number);o.length===3&&o.every(a=>!isNaN(a))&&(t.target=o),this._emit()}),e.querySelector(".t-action").addEventListener("change",i=>{t.action=i.target.value,this._emit()}),e.querySelector(".t-params").addEventListener("change",i=>{try{t.params=JSON.parse(i.target.value)}catch{}this._emit()}),e.querySelector("button").addEventListener("click",()=>this._removeTrigger(s)),this._list.appendChild(e)}}_emit(){var t;(t=this.onChange)==null||t.call(this,this._triggers)}destroy(){this.el.remove()}}const At=["draw","erase","role","triggers","play","save","share","undo","redo","layer","of","settings","language","you_died","you_win","tap_retry","score","saved","save_fail","link_copied","shoot"],q=["en","ru","es","zh","ar","pt","fr","de","ja","ko","hi","it","tr","pl","nl","uk","vi","th","id","ms","sv","cs","ro","el","hu","da","fi","no","sk","bg","hr","sr","lt","lv","et","sl","ka","he","fa","bn"],Bt={en:"English",ru:"Ð ÑƒÑÑÐºÐ¸Ð¹",es:"EspaÃ±ol",zh:"ä¸­æ–‡",ar:"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",pt:"PortuguÃªs",fr:"FranÃ§ais",de:"Deutsch",ja:"æ—¥æœ¬èªž",ko:"í•œêµ­ì–´",hi:"à¤¹à¤¿à¤¨à¥à¤¦à¥€",it:"Italiano",tr:"TÃ¼rkÃ§e",pl:"Polski",nl:"Nederlands",uk:"Ð£ÐºÑ€Ð°Ñ—Ð½ÑÑŒÐºÐ°",vi:"Tiáº¿ng Viá»‡t",th:"à¹„à¸—à¸¢",id:"Bahasa",ms:"Melayu",sv:"Svenska",cs:"ÄŒeÅ¡tina",ro:"RomÃ¢nÄƒ",el:"Î•Î»Î»Î·Î½Î¹ÎºÎ¬",hu:"Magyar",da:"Dansk",fi:"Suomi",no:"Norsk",sk:"SlovenÄina",bg:"Ð‘ÑŠÐ»Ð³Ð°Ñ€ÑÐºÐ¸",hr:"Hrvatski",sr:"Srpski",lt:"LietuviÅ³",lv:"LatvieÅ¡u",et:"Eesti",sl:"SlovenÅ¡Äina",ka:"áƒ¥áƒáƒ áƒ—áƒ£áƒšáƒ˜",he:"×¢×‘×¨×™×ª",fa:"ÙØ§Ø±Ø³ÛŒ",bn:"à¦¬à¦¾à¦‚à¦²à¦¾"},lt=[["Draw","Erase","Role","Triggers","Play","Save","Share","Undo","Redo","Layer","of","Settings","Language","You Died!","You Win!","Tap to retry","Score","Saved!","Save failed","Link copied!","Shoot"],["Ð Ð¸ÑÐ¾Ð²Ð°Ñ‚ÑŒ","Ð¡Ñ‚ÐµÑ€ÐµÑ‚ÑŒ","Ð Ð¾Ð»ÑŒ","Ð¢Ñ€Ð¸Ð³Ð³ÐµÑ€Ñ‹","Ð˜Ð³Ñ€Ð°Ñ‚ÑŒ","Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ","ÐŸÐ¾Ð´ÐµÐ»Ð¸Ñ‚ÑŒÑÑ","ÐžÑ‚Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ","Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒ","Ð¡Ð»Ð¾Ð¹","Ð¸Ð·","ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸","Ð¯Ð·Ñ‹Ðº","Ð¢Ñ‹ Ð¿Ð¾Ð³Ð¸Ð±!","ÐŸÐ¾Ð±ÐµÐ´Ð°!","ÐÐ°Ð¶Ð¼Ð¸ Ð´Ð»Ñ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð°","Ð¡Ñ‡Ñ‘Ñ‚","Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¾!","ÐžÑˆÐ¸Ð±ÐºÐ°","Ð¡ÑÑ‹Ð»ÐºÐ° ÑÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð°!","Ð¡Ñ‚Ñ€ÐµÐ»ÑÑ‚ÑŒ"],["Dibujar","Borrar","Rol","Disparadores","Jugar","Guardar","Compartir","Deshacer","Rehacer","Capa","de","Ajustes","Idioma","Â¡Moriste!","Â¡Ganaste!","Toca para reintentar","Puntos","Â¡Guardado!","Error al guardar","Â¡Enlace copiado!","Disparar"],["ç»˜åˆ¶","æ“¦é™¤","è§’è‰²","è§¦å‘å™¨","å¼€å§‹","ä¿å­˜","åˆ†äº«","æ’¤é”€","é‡åš","å±‚","å…±","è®¾ç½®","è¯­è¨€","ä½ æ­»äº†ï¼","ä½ èµ¢äº†ï¼","ç‚¹å‡»é‡è¯•","åˆ†æ•°","å·²ä¿å­˜ï¼","ä¿å­˜å¤±è´¥","é“¾æŽ¥å·²å¤åˆ¶ï¼","å°„å‡»"],["Ø±Ø³Ù…","Ù…Ø³Ø­","Ø¯ÙˆØ±","Ù…Ø´ØºÙ„Ø§Øª","Ù„Ø¹Ø¨","Ø­ÙØ¸","Ù…Ø´Ø§Ø±ÙƒØ©","ØªØ±Ø§Ø¬Ø¹","Ø¥Ø¹Ø§Ø¯Ø©","Ø·Ø¨Ù‚Ø©","Ù…Ù†","Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª","Ù„ØºØ©","Ù„Ù‚Ø¯ Ù…Øª!","ÙØ²Øª!","Ø§Ù†Ù‚Ø± Ù„Ù„Ù…Ø­Ø§ÙˆÙ„Ø©","Ù†Ù‚Ø§Ø·","ØªÙ… Ø§Ù„Ø­ÙØ¸!","ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸","ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·!","Ø¥Ø·Ù„Ø§Ù‚"],["Desenhar","Apagar","Papel","Gatilhos","Jogar","Salvar","Compartilhar","Desfazer","Refazer","Camada","de","Config.","Idioma","Morreu!","Venceu!","Toque para tentar","Pontos","Salvo!","Erro ao salvar","Link copiado!","Atirar"],["Dessiner","Effacer","RÃ´le","DÃ©clencheurs","Jouer","Sauver","Partager","Annuler","RÃ©tablir","Couche","de","ParamÃ¨tres","Langue","Tu es mort!","Victoire!","Touche pour rÃ©essayer","Score","SauvegardÃ©!","Ã‰chec","Lien copiÃ©!","Tirer"],["Zeichnen","LÃ¶schen","Rolle","AuslÃ¶ser","Spielen","Speichern","Teilen","RÃ¼ckgÃ¤ngig","Wiederherstellen","Ebene","von","Einstellungen","Sprache","Gestorben!","Gewonnen!","Tippen zum Wiederholen","Punkte","Gespeichert!","Fehler","Link kopiert!","SchieÃŸen"],["æã","æ¶ˆã™","å½¹å‰²","ãƒˆãƒªã‚¬ãƒ¼","ãƒ—ãƒ¬ã‚¤","ä¿å­˜","å…±æœ‰","å…ƒã«æˆ»ã™","ã‚„ã‚Šç›´ã™","ãƒ¬ã‚¤ãƒ¤ãƒ¼","ã®","è¨­å®š","è¨€èªž","æ­»äº¡ï¼","å‹åˆ©ï¼","ã‚¿ãƒƒãƒ—ã—ã¦ãƒªãƒˆãƒ©ã‚¤","ã‚¹ã‚³ã‚¢","ä¿å­˜æ¸ˆã¿ï¼","ä¿å­˜å¤±æ•—","ãƒªãƒ³ã‚¯ã‚³ãƒ”ãƒ¼æ¸ˆã¿ï¼","æ’ƒã¤"],["ê·¸ë¦¬ê¸°","ì§€ìš°ê¸°","ì—­í• ","íŠ¸ë¦¬ê±°","í”Œë ˆì´","ì €ìž¥","ê³µìœ ","ì‹¤í–‰ì·¨ì†Œ","ë‹¤ì‹œì‹¤í–‰","ë ˆì´ì–´","ì¤‘","ì„¤ì •","ì–¸ì–´","ì‚¬ë§!","ìŠ¹ë¦¬!","íƒ­í•˜ì—¬ ìž¬ì‹œë„","ì ìˆ˜","ì €ìž¥ë¨!","ì €ìž¥ ì‹¤íŒ¨","ë§í¬ ë³µì‚¬ë¨!","ë°œì‚¬"],["à¤¬à¤¨à¤¾à¤à¤‚","à¤®à¤¿à¤Ÿà¤¾à¤à¤‚","à¤­à¥‚à¤®à¤¿à¤•à¤¾","à¤Ÿà¥à¤°à¤¿à¤—à¤°","à¤–à¥‡à¤²à¥‡à¤‚","à¤¸à¥‡à¤µ","à¤¶à¥‡à¤¯à¤°","à¤…à¤¨à¤¡à¥‚","à¤°à¥€à¤¡à¥‚","à¤ªà¤°à¤¤","à¤•à¤¾","à¤¸à¥‡à¤Ÿà¤¿à¤‚à¤—","à¤­à¤¾à¤·à¤¾","à¤†à¤ª à¤®à¤¾à¤°à¥‡ à¤—à¤!","à¤†à¤ª à¤œà¥€à¤¤à¥‡!","à¤«à¤¿à¤° à¤¸à¥‡ à¤Ÿà¥ˆà¤ª à¤•à¤°à¥‡à¤‚","à¤¸à¥à¤•à¥‹à¤°","à¤¸à¥‡à¤µ à¤¹à¥à¤†!","à¤¸à¥‡à¤µ à¤µà¤¿à¤«à¤²","à¤²à¤¿à¤‚à¤• à¤•à¥‰à¤ªà¥€!","à¤—à¥‹à¤²à¥€"],["Disegna","Cancella","Ruolo","Trigger","Gioca","Salva","Condividi","Annulla","Ripeti","Livello","di","Impostazioni","Lingua","Sei morto!","Hai vinto!","Tocca per riprovare","Punteggio","Salvato!","Errore","Link copiato!","Spara"],["Ã‡iz","Sil","Rol","Tetikleyiciler","Oyna","Kaydet","PaylaÅŸ","Geri al","Yinele","Katman","/","Ayarlar","Dil","Ã–ldÃ¼n!","KazandÄ±n!","Tekrar dene","Puan","Kaydedildi!","Hata","Link kopyalandÄ±!","AteÅŸ"],["Rysuj","WymaÅ¼","Rola","Wyzwalacze","Graj","Zapisz","UdostÄ™pnij","Cofnij","PonÃ³w","Warstwa","z","Ustawienia","JÄ™zyk","ZginÄ…Å‚eÅ›!","WygraÅ‚eÅ›!","Dotknij aby ponowiÄ‡","Wynik","Zapisano!","BÅ‚Ä…d zapisu","Link skopiowany!","Strzelaj"],["Teken","Wis","Rol","Triggers","Speel","Opslaan","Delen","Ongedaan","Opnieuw","Laag","van","Instellingen","Taal","Je bent dood!","Je wint!","Tik om opnieuw","Score","Opgeslagen!","Opslaan mislukt","Link gekopieerd!","Schieten"],["ÐœÐ°Ð»ÑŽÐ²Ð°Ñ‚Ð¸","Ð¡Ñ‚ÐµÑ€Ñ‚Ð¸","Ð Ð¾Ð»ÑŒ","Ð¢Ñ€Ð¸Ð³ÐµÑ€Ð¸","Ð“Ñ€Ð°Ñ‚Ð¸","Ð—Ð±ÐµÑ€ÐµÐ³Ñ‚Ð¸","ÐŸÐ¾Ð´Ñ–Ð»Ð¸Ñ‚Ð¸ÑÑ","Ð¡ÐºÐ°ÑÑƒÐ²Ð°Ñ‚Ð¸","ÐŸÐ¾Ð²ÐµÑ€Ð½ÑƒÑ‚Ð¸","Ð¨Ð°Ñ€","Ð·","ÐÐ°Ð»Ð°ÑˆÑ‚ÑƒÐ²Ð°Ð½Ð½Ñ","ÐœÐ¾Ð²Ð°","Ð¢Ð¸ Ð·Ð°Ð³Ð¸Ð½ÑƒÐ²!","ÐŸÐµÑ€ÐµÐ¼Ð¾Ð³Ð°!","ÐÐ°Ñ‚Ð¸ÑÐ½Ð¸ Ð·Ð½Ð¾Ð²Ñƒ","Ð Ð°Ñ…ÑƒÐ½Ð¾Ðº","Ð—Ð±ÐµÑ€ÐµÐ¶ÐµÐ½Ð¾!","ÐŸÐ¾Ð¼Ð¸Ð»ÐºÐ°","ÐŸÐ¾ÑÐ¸Ð»Ð°Ð½Ð½Ñ ÑÐºÐ¾Ð¿Ñ–Ð¹Ð¾Ð²Ð°Ð½Ð¾!","Ð¡Ñ‚Ñ€Ñ–Ð»ÑÑ‚Ð¸"],["Váº½","XÃ³a","Vai trÃ²","KÃ­ch hoáº¡t","ChÆ¡i","LÆ°u","Chia sáº»","HoÃ n tÃ¡c","LÃ m láº¡i","Lá»›p","cá»§a","CÃ i Ä‘áº·t","NgÃ´n ngá»¯","Báº¡n cháº¿t!","Báº¡n tháº¯ng!","Cháº¡m Ä‘á»ƒ thá»­ láº¡i","Äiá»ƒm","ÄÃ£ lÆ°u!","Lá»—i lÆ°u","ÄÃ£ sao chÃ©p!","Báº¯n"],["à¸§à¸²à¸”","à¸¥à¸š","à¸šà¸—à¸šà¸²à¸—","à¸—à¸£à¸´à¸à¹€à¸à¸­à¸£à¹Œ","à¹€à¸¥à¹ˆà¸™","à¸šà¸±à¸™à¸—à¸¶à¸","à¹à¸Šà¸£à¹Œ","à¹€à¸¥à¸´à¸à¸—à¸³","à¸—à¸³à¸‹à¹‰à¸³","à¸Šà¸±à¹‰à¸™","à¸ˆà¸²à¸","à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²","à¸ à¸²à¸©à¸²","à¸„à¸¸à¸“à¸•à¸²à¸¢!","à¸„à¸¸à¸“à¸Šà¸™à¸°!","à¹à¸•à¸°à¹€à¸žà¸·à¹ˆà¸­à¸¥à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆ","à¸„à¸°à¹à¸™à¸™","à¸šà¸±à¸™à¸—à¸¶à¸à¹à¸¥à¹‰à¸§!","à¸šà¸±à¸™à¸—à¸¶à¸à¸¥à¹‰à¸¡à¹€à¸«à¸¥à¸§","à¸„à¸±à¸”à¸¥à¸­à¸à¸¥à¸´à¸‡à¸à¹Œà¹à¸¥à¹‰à¸§!","à¸¢à¸´à¸‡"],["Gambar","Hapus","Peran","Pemicu","Main","Simpan","Bagikan","Undo","Redo","Lapisan","dari","Pengaturan","Bahasa","Kamu mati!","Kamu menang!","Ketuk untuk coba lagi","Skor","Tersimpan!","Gagal simpan","Link disalin!","Tembak"],["Lukis","Padam","Peranan","Pencetus","Main","Simpan","Kongsi","Buat asal","Buat semula","Lapisan","dari","Tetapan","Bahasa","Anda mati!","Anda menang!","Ketuk untuk cuba lagi","Skor","Disimpan!","Gagal","Pautan disalin!","Tembak"],["Rita","Radera","Roll","UtlÃ¶sare","Spela","Spara","Dela","Ã…ngra","GÃ¶r om","Lager","av","InstÃ¤llningar","SprÃ¥k","Du dog!","Du vann!","Tryck fÃ¶r att fÃ¶rsÃ¶ka","PoÃ¤ng","Sparat!","Misslyckades","LÃ¤nk kopierad!","Skjut"],["Kreslit","Smazat","Role","SpouÅ¡tÄ›","HrÃ¡t","UloÅ¾it","SdÃ­let","ZpÄ›t","Znovu","Vrstva","z","NastavenÃ­","Jazyk","ZemÅ™el jsi!","VyhrÃ¡l jsi!","Klepni znovu","SkÃ³re","UloÅ¾eno!","Chyba","Odkaz zkopÃ­rovÃ¡n!","StÅ™elba"],["DeseneazÄƒ","È˜terge","Rol","DeclanÈ™atoare","JoacÄƒ","SalveazÄƒ","PartajeazÄƒ","AnuleazÄƒ","RefÄƒ","Strat","din","SetÄƒri","LimbÄƒ","Ai murit!","Ai cÃ¢È™tigat!","Atinge pentru a reÃ®ncerca","Scor","Salvat!","Eroare","Link copiat!","Trage"],["Î£Ï‡ÎµÎ´Î¯Î±ÏƒÎµ","Î£Î²Î®ÏƒÎµ","Î¡ÏŒÎ»Î¿Ï‚","Î•Î½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Ï„Î­Ï‚","Î Î±Î¯Î¾Îµ","Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·","ÎšÎ¿Î¹Î½Î¿Ï€Î¿Î¯Î·ÏƒÎ·","Î‘Î½Î±Î¯ÏÎµÏƒÎ·","Î•Ï€Î±Î½Î¬Î»Î·ÏˆÎ·","Î•Ï€Î¯Ï€ÎµÎ´Î¿","Î±Ï€ÏŒ","Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚","Î“Î»ÏŽÏƒÏƒÎ±","Î Î­Î¸Î±Î½ÎµÏ‚!","ÎšÎ­ÏÎ´Î¹ÏƒÎµÏ‚!","Î Î¬Ï„Î± Î¾Î±Î½Î¬","Î£ÎºÎ¿Ï","Î‘Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ!","Î‘Ï€Î¿Ï„Ï…Ï‡Î¯Î±","Î‘Î½Ï„Î¹Î³ÏÎ¬Ï†Î·ÎºÎµ!","Î Ï…ÏÎ¿Î²ÏŒÎ»Î·ÏƒÎµ"],["Rajzolj","TÃ¶rlÃ©s","Szerep","Triggerek","JÃ¡tÃ©k","MentÃ©s","MegosztÃ¡s","VisszavonÃ¡s","Ãšjra","RÃ©teg","bÃ³l","BeÃ¡llÃ­tÃ¡sok","Nyelv","MeghaltÃ¡l!","NyertÃ©l!","Koppints Ãºjra","Pont","Mentve!","Hiba","Link mÃ¡solva!","LÃ¶vÃ©s"],["Tegn","Slet","Rolle","UdlÃ¸sere","Spil","Gem","Del","Fortryd","Gentag","Lag","af","Indstillinger","Sprog","Du dÃ¸de!","Du vandt!","Tryk for at prÃ¸ve igen","Score","Gemt!","Fejl","Link kopieret!","Skyd"],["PiirrÃ¤","Pyyhi","Rooli","Liipaisimet","Pelaa","Tallenna","Jaa","Kumoa","Tee uudelleen","Kerros","/","Asetukset","Kieli","Kuolit!","Voitit!","Napauta uudelleen","Pisteet","Tallennettu!","Virhe","Linkki kopioitu!","Ammu"],["Tegn","Slett","Rolle","UtlÃ¸sere","Spill","Lagre","Del","Angre","GjÃ¸r om","Lag","av","Innstillinger","SprÃ¥k","Du dÃ¸de!","Du vant!","Trykk for Ã¥ prÃ¸ve igjen","Poeng","Lagret!","Feil","Lenke kopiert!","Skyt"],["Kresli","VymaÅ¾","Rola","SpÃºÅ¡Å¥aÄe","Hraj","UloÅ¾","ZdieÄ¾aj","SpÃ¤Å¥","Znova","Vrstva","z","Nastavenia","Jazyk","Zomrel si!","Vyhral si!","Klepni znova","SkÃ³re","UloÅ¾enÃ©!","Chyba","Odkaz skopÃ­rovanÃ½!","StreÄ¾"],["Ð Ð¸ÑÑƒÐ²Ð°Ð¹","Ð˜Ð·Ñ‚Ñ€Ð¸Ð¹","Ð Ð¾Ð»Ñ","Ð¢Ñ€Ð¸Ð³ÐµÑ€Ð¸","Ð˜Ð³Ñ€Ð°Ð¹","Ð—Ð°Ð¿Ð°Ð·Ð¸","Ð¡Ð¿Ð¾Ð´ÐµÐ»Ð¸","ÐžÑ‚Ð¼ÐµÐ½Ð¸","ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸","Ð¡Ð»Ð¾Ð¹","Ð¾Ñ‚","ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸","Ð•Ð·Ð¸Ðº","Ð£Ð¼Ñ€Ñ!","ÐŸÐ¾Ð±ÐµÐ´Ð¸!","ÐÐ°Ñ‚Ð¸ÑÐ½Ð¸ Ð¾Ñ‚Ð½Ð¾Ð²Ð¾","Ð¢Ð¾Ñ‡ÐºÐ¸","Ð—Ð°Ð¿Ð°Ð·ÐµÐ½Ð¾!","Ð“Ñ€ÐµÑˆÐºÐ°","Ð›Ð¸Ð½ÐºÑŠÑ‚ Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð°Ð½!","Ð¡Ñ‚Ñ€ÐµÐ»ÑÐ¹"],["Crtaj","ObriÅ¡i","Uloga","OkidaÄi","Igraj","Spremi","Podijeli","PoniÅ¡ti","Ponovi","Sloj","od","Postavke","Jezik","Umro si!","Pobijedio si!","Dodirni za ponovni pokuÅ¡aj","Bodovi","Spremljeno!","GreÅ¡ka","Link kopiran!","Pucaj"],["Ð¦Ñ€Ñ‚Ð°Ñ˜","ÐžÐ±Ñ€Ð¸ÑˆÐ¸","Ð£Ð»Ð¾Ð³Ð°","Ð¢Ñ€Ð¸Ð³ÐµÑ€Ð¸","Ð˜Ð³Ñ€Ð°Ñ˜","Ð¡Ð°Ñ‡ÑƒÐ²Ð°Ñ˜","ÐŸÐ¾Ð´ÐµÐ»Ð¸","ÐŸÐ¾Ð½Ð¸ÑˆÑ‚Ð¸","ÐŸÐ¾Ð½Ð¾Ð²Ð¸","Ð¡Ð»Ð¾Ñ˜","Ð¾Ð´","ÐŸÐ¾Ð´ÐµÑˆÐ°Ð²Ð°ÑšÐ°","ÐˆÐµÐ·Ð¸Ðº","Ð£Ð¼Ñ€Ð¾ ÑÐ¸!","ÐŸÐ¾Ð±ÐµÐ´Ð¸Ð¾ ÑÐ¸!","Ð”Ð¾Ð´Ð¸Ñ€Ð½Ð¸ Ð¿Ð¾Ð½Ð¾Ð²Ð¾","Ð‘Ð¾Ð´Ð¾Ð²Ð¸","Ð¡Ð°Ñ‡ÑƒÐ²Ð°Ð½Ð¾!","Ð“Ñ€ÐµÑˆÐºÐ°","Ð›Ð¸Ð½Ðº ÐºÐ¾Ð¿Ð¸Ñ€Ð°Ð½!","ÐŸÑƒÑ†Ð°Ñ˜"],["PieÅ¡k","Trink","RolÄ—","Trigeriai","Å½aisk","IÅ¡saugok","Dalinkis","AtÅ¡aukti","Pakartoti","Sluoksnis","iÅ¡","Nustatymai","Kalba","Å½uvai!","LaimÄ—jai!","BakstelÄ—k pakartoti","TaÅ¡kai","IÅ¡saugota!","Klaida","Nuoroda nukopijuota!","Å auk"],["ZÄ«mÄ“","DzÄ“st","Loma","Trigeri","SpÄ“lÄ“","SaglabÄt","DalÄ«ties","Atsaukt","AtkÄrtot","SlÄnis","no","IestatÄ«jumi","Valoda","Tu nomiri!","Tu uzvarÄ“ji!","Pieskaries vÄ“lreiz","Punkti","SaglabÄts!","KÄ¼Å«da","Saite nokopÄ“ta!","Å aut"],["Joonista","Kustuta","Roll","PÃ¤Ã¤stikud","MÃ¤ngi","Salvesta","Jaga","VÃµta tagasi","Tee uuesti","Kiht","/","Seaded","Keel","Sa surid!","Sa vÃµitsid!","Puuduta uuesti","Skoor","Salvestatud!","Viga","Link kopeeritud!","Tulista"],["RiÅ¡i","IzbriÅ¡i","Vloga","SproÅ¾ilci","Igraj","Shrani","Deli","Razveljavi","Ponovi","Plast","od","Nastavitve","Jezik","Umrl si!","Zmagal si!","Tapni za ponovitev","ToÄke","Shranjeno!","Napaka","Povezava kopirana!","Streljaj"],["áƒ®áƒáƒ¢áƒ•áƒ","áƒ¬áƒáƒ¨áƒšáƒ","áƒ áƒáƒšáƒ˜","áƒ¢áƒ áƒ˜áƒ’áƒ”áƒ áƒ”áƒ‘áƒ˜","áƒ—áƒáƒ›áƒáƒ¨áƒ˜","áƒ¨áƒ”áƒœáƒáƒ®áƒ•áƒ","áƒ’áƒáƒ–áƒ˜áƒáƒ áƒ”áƒ‘áƒ","áƒ’áƒáƒ£áƒ¥áƒ›áƒ”áƒ‘áƒ","áƒ’áƒáƒ›áƒ”áƒáƒ áƒ”áƒ‘áƒ","áƒ¤áƒ”áƒœáƒ","áƒ“áƒáƒœ","áƒžáƒáƒ áƒáƒ›áƒ”áƒ¢áƒ áƒ”áƒ‘áƒ˜","áƒ”áƒœáƒ","áƒ›áƒáƒ™áƒ•áƒ“áƒ˜!","áƒ’áƒáƒ˜áƒ›áƒáƒ áƒ¯áƒ•áƒ”!","áƒ¨áƒ”áƒ”áƒ®áƒ” áƒ®áƒ”áƒšáƒáƒ®áƒšáƒ","áƒ¥áƒ£áƒšáƒ","áƒ¨áƒ”áƒœáƒáƒ®áƒ£áƒšáƒ˜áƒ!","áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ","áƒ‘áƒ›áƒ£áƒšáƒ˜ áƒ™áƒáƒžáƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ˜áƒ!","áƒ¡áƒ áƒáƒšáƒ"],["×¦×™×™×¨","×ž×—×§","×ª×¤×§×™×“","×˜×¨×™×’×¨×™×","×©×—×§","×©×ž×•×¨","×©×ª×£","×‘×˜×œ","×©×—×–×¨","×©×›×‘×”","×ž×ª×•×š","×”×’×“×¨×•×ª","×©×¤×”","×ž×ª×ª!","× ×™×¦×—×ª!","×”×§×© ×œ× ×¡×•×ª ×©×•×‘","× ×™×§×•×“","× ×©×ž×¨!","×©×’×™××”","×”×§×™×©×•×¨ ×”×•×¢×ª×§!","×™×¨×”"],["ØªØ±Ø³ÛŒÙ…","Ù¾Ø§Ú©","Ù†Ù‚Ø´","Ù…Ø­Ø±Ú©â€ŒÙ‡Ø§","Ø¨Ø§Ø²ÛŒ","Ø°Ø®ÛŒØ±Ù‡","Ø§Ø´ØªØ±Ø§Ú©","ÙˆØ§Ú¯Ø±Ø¯","Ø¨Ø§Ø²Ú¯Ø±Ø¯","Ù„Ø§ÛŒÙ‡","Ø§Ø²","ØªÙ†Ø¸ÛŒÙ…Ø§Øª","Ø²Ø¨Ø§Ù†","Ù…Ø±Ø¯ÛŒ!","Ø¨Ø±Ø¯ÛŒ!","Ù„Ù…Ø³ Ø¨Ø±Ø§ÛŒ ØªÙ„Ø§Ø´ Ù…Ø¬Ø¯Ø¯","Ø§Ù…ØªÛŒØ§Ø²","Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯!","Ø®Ø·Ø§","Ù„ÛŒÙ†Ú© Ú©Ù¾ÛŒ Ø´Ø¯!","Ø´Ù„ÛŒÚ©"],["à¦†à¦à¦•à§à¦¨","à¦®à§à¦›à§à¦¨","à¦­à§‚à¦®à¦¿à¦•à¦¾","à¦Ÿà§à¦°à¦¿à¦—à¦¾à¦°","à¦–à§‡à¦²à§à¦¨","à¦¸à§‡à¦­","à¦¶à§‡à¦¯à¦¼à¦¾à¦°","à¦ªà§‚à¦°à§à¦¬à¦¾à¦¬à¦¸à§à¦¥à¦¾","à¦ªà§à¦¨à¦°à¦¾à¦¯à¦¼","à¦¸à§à¦¤à¦°","à¦à¦°","à¦¸à§‡à¦Ÿà¦¿à¦‚à¦¸","à¦­à¦¾à¦·à¦¾","à¦†à¦ªà¦¨à¦¿ à¦®à¦¾à¦°à¦¾ à¦—à§‡à¦›à§‡à¦¨!","à¦†à¦ªà¦¨à¦¿ à¦œà¦¿à¦¤à§‡à¦›à§‡à¦¨!","à¦†à¦¬à¦¾à¦° à¦šà§‡à¦·à§à¦Ÿà¦¾ à¦•à¦°à§à¦¨","à¦¸à§à¦•à§‹à¦°","à¦¸à§‡à¦­ à¦¹à¦¯à¦¼à§‡à¦›à§‡!","à¦¸à§‡à¦­ à¦¬à§à¦¯à¦°à§à¦¥","à¦²à¦¿à¦‚à¦• à¦•à¦ªà¦¿ à¦¹à¦¯à¦¼à§‡à¦›à§‡!","à¦—à§à¦²à¦¿"]];let U=0;function ct(h){const t=q.indexOf(h);t>=0&&(U=t),localStorage.setItem("vd_lang",h)}function Rt(){return q[U]}function k(h){var e;const t=At.indexOf(h);return t<0?h:((e=lt[U])==null?void 0:e[t])??lt[0][t]??h}function $t(){return q.map(h=>({code:h,name:Bt[h]||h}))}function Nt(){var s;const h=localStorage.getItem("vd_lang");if(h){ct(h);return}const t=((s=navigator.language)==null?void 0:s.slice(0,2))||"en",e=q.indexOf(t);e>=0&&(U=e)}const Ot={top:[0,1,0],bottom:[0,-1,0],front:[0,0,1],back:[0,0,-1],right:[1,0,0],left:[-1,0,0]};class Yt{constructor(t,e){this._tool="draw",this._undoStack=[],this._redoStack=[],this._dragDist=0,this._longPressTimer=0,this._world=t,this._sidePanel=document.createElement("div"),this._sidePanel.className="side-panel edit-only",this._sidePanel.innerHTML='<button class="sp-btn sp-undo" title="Undo">&#8630;</button><button class="sp-btn sp-redo" title="Redo">&#8631;</button>',e.appendChild(this._sidePanel),this._undoBtn=this._sidePanel.querySelector(".sp-undo"),this._redoBtn=this._sidePanel.querySelector(".sp-redo"),this._undoBtn.addEventListener("click",()=>this._undo()),this._redoBtn.addEventListener("click",()=>this._redo()),this._editorWrap=document.createElement("div"),this._editorWrap.className="editor-3d edit-only",e.appendChild(this._editorWrap),this._cam=new Q("orbit"),this._cam.state.distance=35,this._cam.state.rotationX=-30,this._cam.state.rotationY=35,this._cam.state.target.set(16,4,16),this._renderer=new tt(this._editorWrap,this._cam,700,8),this._mesh=new et(8),this._renderer.world.appendChild(this._mesh.el),this._mesh.el.style.transformStyle="preserve-3d",this._bindEditorInput();const s=()=>{this._renderer.render(),requestAnimationFrame(s)};requestAnimationFrame(s),this.palette=new Pt(t.palette),e.appendChild(this.palette.el),e.appendChild(this.palette.roleBar),this.triggerEditor=new Ct,this.triggerEditor.onChange=i=>{t.triggers=i},this.triggerEditor.load(t.triggers),e.appendChild(this.triggerEditor.el),this.toolbar=document.createElement("div"),this.toolbar.className="toolbar edit-only",this._rebuildToolbar(),e.appendChild(this.toolbar),this._bindToolbar(),this._refreshMesh(),this._updateUndoButtons()}_bindEditorInput(){let t=!1,e=0,s=0,i=null;const o=(r,c,d)=>{t=!0,e=r,s=c,this._dragDist=0,i=d,this._longPressTimer=window.setTimeout(()=>{this._dragDist<5&&this._handleErase(i),i=null},500)},a=(r,c)=>{if(!t)return;const d=r-e,l=c-s;this._dragDist+=Math.abs(d)+Math.abs(l),this._cam.orbit(d*.4,l*.4),e=r,s=c},n=()=>{clearTimeout(this._longPressTimer),t&&this._dragDist<5&&i&&this._handleClick(i),t=!1,i=null};this._editorWrap.addEventListener("mousedown",r=>o(r.clientX,r.clientY,r.target)),window.addEventListener("mousemove",r=>a(r.clientX,r.clientY)),window.addEventListener("mouseup",()=>n()),this._editorWrap.addEventListener("touchstart",r=>{r.preventDefault(),o(r.touches[0].clientX,r.touches[0].clientY,r.target)},{passive:!1}),this._editorWrap.addEventListener("touchmove",r=>{r.touches.length===1&&a(r.touches[0].clientX,r.touches[0].clientY)},{passive:!0}),this._editorWrap.addEventListener("touchend",()=>n()),this._editorWrap.addEventListener("wheel",r=>{r.preventDefault(),this._cam.zoom(r.deltaY*.02)},{passive:!1}),this._editorWrap.addEventListener("contextmenu",r=>{r.preventDefault(),this._handleErase(r.target)})}_handleClick(t){if(!t.dataset.n)return;if(this._tool==="erase"){this._handleErase(t);return}if(this._tool==="role"){const u=+t.dataset.x,p=+t.dataset.y,m=+t.dataset.z,_=this._world.get(u,p,m);if(_===0)return;const b=this._world.getRole(u,p,m),f=this.palette.selectedRole;if(b===f)return;this._world.set(u,p,m,_,f),this._pushUndo(u,p,m,_,b,_,f),this._refreshMesh(),w("click");return}const e=t.dataset.n,s=+t.dataset.x,i=+t.dataset.y,o=+t.dataset.z,a=Ot[e];if(!a)return;const n=s+a[0],r=i+a[1],c=o+a[2];if(n<0||n>=32||r<0||r>=32||c<0||c>=32||this._world.get(n,r,c)!==0)return;const d=this.palette.selectedColor,l=this.palette.selectedRole;this._world.set(n,r,c,d,l),this._pushUndo(n,r,c,0,0,d,l),this._refreshMesh(),w("place")}_handleErase(t){if(!t.dataset.n)return;const e=+t.dataset.x,s=+t.dataset.y,i=+t.dataset.z,o=this._world.get(e,s,i),a=this._world.getRole(e,s,i);o!==0&&(this._world.clear(e,s,i),this._pushUndo(e,s,i,o,a,0,0),this._refreshMesh(),w("click"))}_pushUndo(t,e,s,i,o,a,n){this._undoStack.push({x:t,y:e,z:s,oldBlock:i,oldRole:o,newBlock:a,newRole:n}),this._undoStack.length>200&&this._undoStack.shift(),this._redoStack.length=0,this._updateUndoButtons()}_undo(){const t=this._undoStack.pop();t&&(this._world.set(t.x,t.y,t.z,t.oldBlock,t.oldRole),this._redoStack.push(t),this._refreshMesh(),this._updateUndoButtons(),w("click"))}_redo(){const t=this._redoStack.pop();t&&(this._world.set(t.x,t.y,t.z,t.newBlock,t.newRole),this._undoStack.push(t),this._refreshMesh(),this._updateUndoButtons(),w("click"))}_updateUndoButtons(){this._undoBtn.classList.toggle("disabled",this._undoStack.length===0),this._redoBtn.classList.toggle("disabled",this._redoStack.length===0)}_rebuildToolbar(){this.toolbar.innerHTML=`<button class="active" data-tool="draw">${k("draw")}</button><button data-tool="erase">${k("erase")}</button><button data-tool="role">${k("role")}</button><button class="tb-triggers">${k("triggers")}</button><select class="tb-lang"></select><div class="tb-spacer"></div><button class="tb-play">${k("play")}</button><button class="tb-save">${k("save")}</button><button class="tb-share">${k("share")}</button>`;const t=this.toolbar.querySelector(".tb-lang");for(const{code:e,name:s}of $t()){const i=document.createElement("option");i.value=e,i.textContent=s,e===Rt()&&(i.selected=!0),t.appendChild(i)}t.addEventListener("change",()=>{ct(t.value),this._rebuildToolbar(),this._bindToolbar()})}_bindToolbar(){this.toolbar.addEventListener("click",t=>{var i,o,a;const e=t.target.closest("button");if(!e)return;const s=e.dataset.tool;if(s){this._tool=s,this.toolbar.querySelectorAll("[data-tool]").forEach(n=>n.classList.toggle("active",n===e)),this.palette.showRoles(s==="role");return}e.classList.contains("tb-triggers")?this.triggerEditor.show():e.classList.contains("tb-play")?(i=this.onPlay)==null||i.call(this):e.classList.contains("tb-save")?(o=this.onSave)==null||o.call(this):e.classList.contains("tb-share")&&((a=this.onShare)==null||a.call(this))})}_refreshMesh(){this._mesh.rebuildFromGrid(this._world.grid,this._world.palette)}refresh(){this._refreshMesh(),this.triggerEditor.load(this._world.triggers)}setVisible(t){const e=t?"":"none";this._editorWrap.style.display=e,this.palette.el.style.display=e,this.palette.roleBar.style.display="none",this.toolbar.style.display=t?"flex":"none",this._sidePanel.style.display=t?"flex":"none",t&&this.triggerEditor.hide()}destroy(){this.palette.destroy(),this.triggerEditor.destroy(),this.toolbar.remove(),this._editorWrap.remove(),this._renderer.destroy(),this._sidePanel.remove()}}const Z="voxeldom_save";function Gt(h){var t;try{const e=JSON.stringify(h);localStorage.setItem(Z,e);const s=(t=window.Telegram)==null?void 0:t.WebApp;return s!=null&&s.CloudStorage&&s.CloudStorage.setItem(Z,e),!0}catch{return!1}}function It(){try{const h=localStorage.getItem(Z);if(!h)return null;const t=JSON.parse(h);return t.v!==1?null:t}catch{return null}}function jt(h){const t=JSON.stringify(h);return btoa(unescape(encodeURIComponent(t)))}function Ft(h){try{const t=decodeURIComponent(escape(atob(h))),e=JSON.parse(t);return e.v===1?e:null}catch{return null}}function V(){var h;return((h=window.Telegram)==null?void 0:h.WebApp)??null}function Kt(){const h=V();h&&(h.ready(),h.expand())}function H(h="light"){var t,e;(e=(t=V())==null?void 0:t.HapticFeedback)==null||e.impactOccurred(h)}function qt(h){var e;const t=V();t?t.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(h)}`):(e=navigator.clipboard)==null||e.writeText(h)}function J(h,t){const e=V();e&&(h?(e.BackButton.show(),t&&e.BackButton.onClick(t)):e.BackButton.hide())}class Ut{constructor(t){this._player=null,this._mode="splash",this._jumpPressed=!1,this._shootPressed=!1,this._health=3,this._maxHealth=3,this._damageCooldown=0,this._splashEl=null,this._race=null,Nt(),Kt();const e=document.querySelector(t);if(!e)throw new Error("Container not found");this._container=e,this._flashEl=document.createElement("div"),this._flashEl.className="flash",e.appendChild(this._flashEl),this._world=new ht;const s=new URLSearchParams(location.search).get("g");if(s){const i=Ft(s);i?this._world.deserialize(i):this._world.generateDefault()}else{const i=It();i?this._world.deserialize(i):this._world.generateDefault()}this._engine=new pt({container:e,voxelSize:16,perspective:700}),this._engine.renderer.root.style.display="none",this._mesh=new et(16),this._engine.scene.add(this._mesh),this._triggers=new kt,this._gyro=new Et,this._hud=new Tt,e.appendChild(this._hud.el),this._hud.el.style.display="none",this._hud.onJump=()=>{this._jumpPressed=!0},this._hud.onShoot=()=>{this._shootPressed=!0},this._engine.onUpdate(i=>this._update(i)),this._engine.start(),this._engine.pause(),s?(this._initEditor(),this.setMode("play")):this._showSplash(),J(!1)}_initEditor(){this._editor||(this._editor=new Yt(this._world,this._container),this._editor.onPlay=()=>this.setMode("play"),this._editor.onSave=()=>this._save(),this._editor.onShare=()=>this._share(),this._editor.setVisible(!1))}_showSplash(){this._mode="splash",this._container.className="mode-splash",this._splashEl=document.createElement("div"),this._splashEl.className="splash",this._splashEl.innerHTML='<div class="splash-title">PEEP</div><div class="splash-sub">wheelchair racer</div><button class="splash-start">START</button>',this._container.appendChild(this._splashEl),this._splashEl.querySelector(".splash-start").addEventListener("click",()=>{w("click"),this._startRace()})}_startRace(){this._splashEl&&(this._splashEl.remove(),this._splashEl=null),this._mode="race",this._container.className="mode-race",this._race=new zt(this._container),this._race.onFinish=t=>{this._flashEl.classList.add("on"),setTimeout(()=>{var e;(e=this._race)==null||e.destroy(),this._race=null,this._initEditor(),this.setMode("edit"),setTimeout(()=>this._flashEl.classList.remove("on"),300)},1e3)},this._race.start()}setMode(t){var e;if(this._mode=t,this._container.className=t==="edit"?"mode-edit":"mode-play",t==="edit")this._initEditor(),this._editor.setVisible(!0),this._editor.refresh(),this._hud.setDpadVisible(!1),this._hud.showMessage(""),this._hud.el.style.display="none",this._player=null,this._engine.camera.mode="orbit",this._engine.renderer.root.style.display="none",this._engine.pause(),this._gyro.stop(),J(!1);else{(e=this._editor)==null||e.setVisible(!1),this._hud.el.style.display="",this._hud.setDpadVisible(!0),this._hud.showMessage(""),this._engine.renderer.root.style.display="",this._engine.resume(),this._player=new xt(this._world),this._triggers.reset(),this._mesh.rebuildFromGrid(this._world.grid,this._world.palette),this._health=this._maxHealth,this._damageCooldown=0,this._engine.camera.mode="fly",this._engine.camera.state.rotationX=0,this._engine.camera.state.rotationY=0;const s=this._world.findSpawn();this._engine.camera.state.position.set(s[0]+.5,s[1]+1.5,s[2]+.5),this._gyro.requestPermission().then(i=>{i&&this._gyro.start()}),J(!0,()=>this.setMode("edit"))}}_update(t){if(this._mode!=="play")return;const e=this._player;if(!e)return;const s=this._engine.input.state.keys,i=this._hud.getMoveInput();let o=i.forward,a=i.right;(s.has("KeyW")||s.has("ArrowUp"))&&(o+=1),(s.has("KeyS")||s.has("ArrowDown"))&&(o-=1),(s.has("KeyA")||s.has("ArrowLeft"))&&(a-=1),(s.has("KeyD")||s.has("ArrowRight"))&&(a+=1);const n=this._jumpPressed||s.has("Space");this._jumpPressed=!1;const{deltaX:r,deltaY:c,pinchDelta:d}=this._engine.input.state;r&&this._engine.camera.orbit(r*.3,0),c&&this._engine.camera.orbit(0,c*.3),d&&this._engine.camera.zoom(d*2),this._engine.input.resetDeltas(),e.state.yaw=this._engine.camera.state.rotationY*(Math.PI/180),this._gyro.update(this._engine.camera);const l=e.move(o,a,n,t);l&&(w(l),H(l==="hit"?"heavy":"light")),this._shootPressed&&(this._shootPressed=!1,this._shoot());const u=this._triggers.evaluate(this._world.triggers,e.state,this._world,t);this._handleEvents(u);const p=this._engine.camera.state;p.position.x=e.state.x,p.position.y=e.state.y+1.5,p.position.z=e.state.z,this._damageCooldown>0&&(this._damageCooldown-=t),!e.state.alive&&this._health>0&&this._damageCooldown<=0&&(this._health--,this._damageCooldown=1,this._health>0&&(e.state.alive=!0,w("hit"),H("heavy"))),this._hud.el.querySelector(".hud-top").innerHTML=`<span class="hud-score">${e.state.score}</span> &nbsp; ${"&#9829;".repeat(this._health)}${"&#9825;".repeat(this._maxHealth-this._health)}`,!e.state.alive&&this._health<=0?(this._hud.showMessage(`${k("you_died")} ${k("tap_retry")}`),this._waitForTap(()=>{e.respawn(),this._health=this._maxHealth,this._hud.showMessage(""),this._mesh.rebuildFromGrid(this._world.grid,this._world.palette)})):e.state.won&&(this._hud.showMessage(k("you_win")),this._waitForTap(()=>this.setMode("edit")))}_shoot(){const t=this._player;if(!t)return;w("hit"),H("medium");const e=this._engine.camera.state.rotationY*(Math.PI/180),s=this._engine.camera.state.rotationX*(Math.PI/180),i=-Math.sin(e)*Math.cos(s),o=Math.sin(s),a=Math.cos(e)*Math.cos(s);let n=t.state.x,r=t.state.y+1.5,c=t.state.z;for(let d=0;d<50;d++){n+=i*.3,r+=o*.3,c+=a*.3;const l=Math.floor(n),u=Math.floor(r),p=Math.floor(c);if(this._world.isSolid(l,u,p)){this._world.clear(l,u,p),this._mesh.rebuildFromGrid(this._world.grid,this._world.palette),w("explode");return}}}_handleEvents(t){for(const e of t)e.type==="text"?this._hud.toast(e.text,3e3):e.type==="sound"?w(e.sound):e.type==="win"?w("win"):e.type==="lose"?w("lose"):e.type==="teleport"&&w("pickup");t.some(e=>e.type==="sound"&&e.sound==="explode")&&this._mesh.rebuildFromGrid(this._world.grid,this._world.palette)}_waitForTap(t){const e=()=>{document.removeEventListener("pointerdown",e),t()};setTimeout(()=>document.addEventListener("pointerdown",e),500)}_save(){const t=Gt(this._world.serialize());this._hud.toast(k(t?"saved":"save_fail"),1500),w("pickup")}_share(){const t=jt(this._world.serialize()),e=`${location.origin}${location.pathname}?g=${t}`;qt(e),this._hud.toast(k("link_copied"),1500)}}const Vt=new Ut("#app");window.voxelApp=Vt;
